# Стратегія тестування

## 1. Поточний стан тестування

На поточному етапі в проєкті використовуються модульні та функціональні тести, реалізовані за допомогою pytest і тестового клієнта Flask.

Ці тести перевіряють:

**Аутентифікацію та авторизацію (test_auth.py, test_auth_routes.py):**
обробку JWT, доступ за ролями (адміністратор / працівник / клієнт), валідацію токенів і захист маршрутів.

**Основні API-ендпоїнти (test_users.py, test_rooms.py, test_bookings.py):**
CRUD-операції для користувачів, кімнат і бронювань.

**Життєвий цикл бази даних (conftest.py):**
тимчасова тестова база PostgreSQL або SQLite створюється та знищується для кожної сесії тестування.

### Запуск тестів

```bash
docker-compose -f docker-compose.test.yml run --rm app
```

Усі тести виконуються автоматично в середовищі CI після створення pull request.

## 2. План розширення тестів

| Тип тестів | Призначення | Запланований обсяг |
|------------|-------------|-------------------|
| Інтеграційні тести | Перевірка взаємодії між компонентами (API, БД, авторизація). | Розширення покриття життєвого циклу бронювання (створення => оновлення => скасування => видалення) і дій адміністратора. |
| Системні тести | Перевірка повного наскрізного потоку від входу до бази даних. | Запуск на тестовій (staging) базі з реалістичними даними для перевірки повних сценаріїв (реєстрація користувача => бронювання => скасування). |
| Приймальні тести | Перевірка відповідності функціоналу бізнес-вимогам. | Виконуються за QA-чеклистами перед кожним релізом. |

## 3. Спеціалізовані плани тестування

| Категорія | Опис |
|-----------|------|
| Тестування продуктивності | Планується використання locust або k6 для вимірювання часу відгуку, пропускної здатності та одночасних запитів до API (особливо /auth/login, /bookings/). |
| Тестування безпеки | Базова перевірка JWT уже реалізована. У майбутньому - статичний аналіз безпеки за допомогою bandit і перевірки на проникнення (повторне використання токенів, SQL-ін'єкції). |

## 4. Інтеграція з CI/CD-процесом

### Безперервна інтеграція (CI)

- Усі тести (pytest) запускаються автоматично під час кожного pull request.
- Звіт про покриття створюється через pytest-cov.
- Контроль якості: збірка вважається невдалою, якщо покриття < 80% або хоча б один тест не пройдено.

### Безперервне розгортання (CD)

- Після успішного проходження CI створюється Docker-образ і розгортається на staging-середовищі.
- Автоматично виконуються smoke-тести (перевірка працездатності API).

### Використовувані інструменти

- pytest, pytest-cov - основне тестування
- flake8 - статичний аналіз коду
- bandit - перевірка безпеки
- locust / k6 - тестування продуктивності
- GitHub Actions - CI/CD

## 5. Метрики якості та пороги прийнятності

| Метрика | Цільове значення | Опис |
|---------|------------------|------|
| Покриття тестами | ≥ 80% | Гарантує перевірку основної логіки. |
| Стабільність збірки | 100% тестів успішно | Обов'язкова умова для злиття (merge). |
| Середній час відгуку API | ≤ 200 мс | Вимірюється під час тестів продуктивності. |
| Перевірка безпеки | 0 критичних уразливостей | Контролюється за допомогою bandit. |